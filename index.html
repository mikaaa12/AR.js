<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>AR.js GPS Demo</title>
    <!-- A-Frame Library -->
    <script src="https://aframe.io/releases/1.3.0/aframe.min.js"></script>
    <!-- AR.js for A-Frame -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene 
        vr-mode-ui="enabled: false" 
        embedded
        arjs="sourceType: webcam; sourceWidth:1280; sourceHeight:960; displayWidth: 1280; displayHeight: 960; debugUIEnabled: true;">
        <!-- Kamera dengan dukungan GPS -->
        <a-camera gps-camera rotation-reader></a-camera>
        <!-- Objek 3D -->
        <a-box
            id="ar-box"
            gps-entity-place="latitude: 0; longitude: 0;"
            scale="5 5 5"
            material="color: red;"
            visible="false">
        </a-box>
    </a-scene>

    <!-- Form untuk input latitude dan longitude -->
    <div style="position: absolute; top: 10px; left: 10px; background: white; padding: 10px; z-index: 10;">
        <label>Latitude:</label>
        <input type="number" id="latitude" step="any" placeholder="e.g., -6.200000">
        <br>
        <label>Longitude:</label>
        <input type="number" id="longitude" step="any" placeholder="e.g., 106.816666">
        <br>
        <button onclick="setLocation()">Set Location</button>
    </div>

    <script>
      function setLocation() {
        const lat = parseFloat(document.getElementById('latitude').value);
        const lon = parseFloat(document.getElementById('longitude').value);
        const entity = document.getElementById('ar-box');

        if (!isNaN(lat) && !isNaN(lon)) {
          // Set latitude and longitude attributes
          entity.setAttribute('gps-entity-place', `latitude: ${lat}; longitude: ${lon};`);
          
          // Make the entity visible
          entity.setAttribute('visible', 'true');

          // Log to check if the coordinates are being set correctly
          console.log(`Object set at latitude: ${lat}, longitude: ${lon}`);
        } else {
          alert('Please enter both latitude and longitude.');
        }
      }

      // Listen for when the entity is added to the scene
      window.addEventListener('gps-entity-place-added', (ev) => {
          console.log('Entity added at: ', ev.detail.latitude, ev.detail.longitude);
      });

      // Additional listener to check if GPS data is available
      document.querySelector('a-scene').addEventListener('loaded', (ev) => {
          console.log('AR.js scene loaded');
      });

      document.querySelector('[gps-camera]').addEventListener('gps-camera-update-position', (event) => {
          console.log('GPS Camera position updated:', event.detail.position);
      });

    </script>
</body>
</html>
